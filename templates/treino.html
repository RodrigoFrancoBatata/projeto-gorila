<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>{{ dia }} | Projeto Gorila</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <div class="container">
    <a href="/" class="voltar">&larr; Voltar</a>
    <h2>{{ dia }}</h2>

    {% for exercicio in exercicios %}
      {% set i = loop.index0 %}
      <div class="exercicio{% if exercicio.concluido %} concluido{% endif %}">
        <h3>{{ exercicio.exercicio }}</h3>
        {% if exercicio.imagem %}
          <img src="/static/imagens/{{ exercicio.imagem }}" alt="{{ exercicio.exercicio }}">
        {% endif %}
        <p><strong>SÃ©rie:</strong> {{ exercicio.series }} &nbsp;&nbsp; <strong>Carga:</strong> {{ exercicio.carga }}</p>

        <form method="post">
          <input type="hidden" name="index" value="{{ i }}">
          <button type="submit" name="concluido" class="botao-acao" style="background:#00c853;color:white;">{% if exercicio.concluido %}Desmarcar{% else %}ConcluÃ­do{% endif %}</button>
        </form>

        <div class="descanso">
          <button onclick="iniciarDescanso(30, this)">30s</button>
          <button onclick="iniciarDescanso(45, this)">45s</button>
          <button onclick="iniciarDescanso(60, this)">60s</button>
        </div>

        <form method="post">
          <input type="hidden" name="index" value="{{ i }}">
          <label><strong>Editar carga:</strong></label>
          <input type="text" name="nova_carga" placeholder="Nova carga">
          <button type="submit">Salvar</button>
        </form>

        <form method="post" action="/excluir/{{ dia }}/{{ i }}">
          <button type="submit" class="excluir">Excluir</button>
        </form>
      </div>
    {% endfor %}

    <h3>Adicionar Novo ExercÃ­cio</h3>
    <form method="post" action="/adicionar/{{ dia }}" enctype="multipart/form-data">
      <input type="text" name="exercicio" placeholder="Nome do exercÃ­cio" required>
      <label>Foto do equipamento:</label>
      <input type="file" name="imagem">
      <input type="text" name="series" placeholder="SÃ©ries" required>
      <input type="text" name="carga" placeholder="Carga (kg)" required>
      <button type="submit">+ Adicionar</button>
    </form>
  </div>

  <button class="dark-toggle" onclick="toggleDark()">ðŸŒ™</button>
  <script>
    const toggleDark = () => {
      document.body.classList.toggle("dark");
      localStorage.setItem("darkmode", document.body.classList.contains("dark"));
    };
    window.onload = () => {
      if (localStorage.getItem("darkmode") === "true") {
        document.body.classList.add("dark");
      }
    };
    function iniciarDescanso(segundos, botao) {
      let tempo = segundos;
      botao.disabled = true;
      const original = botao.textContent;
      const intervalo = setInterval(() => {
        if (tempo > 0) {
          botao.textContent = `${tempo--}s`;
        } else {
          clearInterval(intervalo);
          botao.textContent = original;
          botao.disabled = false;
        }
      }, 1000);
    }
  </script>
</body>
</html>
